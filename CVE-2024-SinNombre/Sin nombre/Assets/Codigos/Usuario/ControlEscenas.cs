using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.Networking;
using UnityEngine.SceneManagement;
using UnityEditor.ShaderGraph.Serialization;
using System.Runtime.ConstrainedExecution;
using UnityEngine.UI;
using UnityEngine.Video;

public class ControlEscenas : MonoBehaviour
{
    public Image Barra;
    public float porcentage;
    public TMPro.TextMeshProUGUI Progreso;
    [SerializeField]
    private GameObject ActivarBarra;
    AsyncOperation Operacion;

    public Image Intro;
    public float Porc;
    AsyncOperation Inicio;
    //Cambiar escenarios.

    public void Update()
    {
        if (Input.GetKeyDown(KeyCode.KeypadEnter) || Input.GetKeyDown(KeyCode.Space))
        {
            StartCoroutine(IniciarJuego(1));
        }

    }
    public void cargarE(string nombreE)
    {
        SceneManager.LoadScene(nombreE);

    }

    public void Iniciar()
    {
        ActivarBarra.SetActive(true);
        StartCoroutine(CargandoSimulacion(2));
    }
    IEnumerator CargandoSimulacion(int nivel)
    {
        Operacion = SceneManager.LoadSceneAsync(nivel);
        Progreso.text = "Cargando.... ";

        while (!Operacion.isDone)
        {
            Barra.fillAmount = Operacion.progress;
            porcentage = Operacion.progress * 100 / 0.9f;
            Progreso.text = "Cargando.... " + porcentage.ToString("00") + "%";
            yield return null;
            
        }
    }

    IEnumerator IniciarJuego(int n)
    {
        Inicio = SceneManager.LoadSceneAsync(n);
        while(!Inicio.isDone)
        {
            Intro.fillAmount = Inicio.progress;
            Porc = Inicio.progress * 100 / 1f;
            yield return null;
        }


    }

    public void Salir()
    {
        Application.Quit();
        Debug.Log("Esta saliendo");
    }
    
    public void Reiniciar()
    {
        ActivarBarra.SetActive(true);
        StartCoroutine(CargandoSimulacion(1));
    }

}
