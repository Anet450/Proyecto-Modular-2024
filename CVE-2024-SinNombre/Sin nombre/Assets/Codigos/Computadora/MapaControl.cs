using System.Collections;
using System.Collections.Generic;
using System.Security.Cryptography;
using UnityEngine;
using UnityEngine.Rendering;
using static ObtenerDatos;

public class MapaControl : MonoBehaviour
{
    public Virus virus;
    [SerializeField]
    private GameObject Total;
    [SerializeField]
    private GameObject Piso1;
    [SerializeField] 
    private GameObject Piso2;
    [SerializeField] 
    private GameObject Piso3;
    [SerializeField] 
    private GameObject Site;

    //_______Contador
    [SerializeField]
    private TMPro.TextMeshProUGUI[] TotalesActivados;
    [SerializeField]
    private TMPro.TextMeshProUGUI[] TotalesDesactivado;

    [SerializeField]
    private TMPro.TextMeshProUGUI[] Piso1Activados;
    [SerializeField]
    private TMPro.TextMeshProUGUI[] Piso1Desactivado;
    [SerializeField]
    private TMPro.TextMeshProUGUI[] Piso2Activados;
    [SerializeField]
    private TMPro.TextMeshProUGUI[] Piso2Desactivado;
    [SerializeField]
    private TMPro.TextMeshProUGUI[] Piso3Activados;
    [SerializeField]
    private TMPro.TextMeshProUGUI[] Piso3Desactivado;
    [SerializeField]
    private TMPro.TextMeshProUGUI[] SiteActivados;
    [SerializeField]
    private TMPro.TextMeshProUGUI[] SiteDesactivado; 

    // Lista de puertas
    public List<Door> doors = new List<Door>();
    // Lista de Computadoras IP
    public List<Computadora_IP> computadoras = new List<Computadora_IP>();
    // Lista de alarmas
    public List<Alarm> alarmas = new List<Alarm>();
    // Lista de camaras
    public List<Cameras> camaras = new List<Cameras>();

    private int ContadorDesactivados(int Piso, int Tipo)
    {
        // Piso 
        // 0 = Total
        // 1 = Piso 1
        // 2 = Piso 2
        // 3 = Piso 3
        // 4 = Site
        // Tipo
        // 0 = Computadora
        // 1 = Camara
        // 2 = Alarma
        // 3 = Puerta
        switch (Tipo)
        {
            case 0: // Computadora
                if (Piso == 0)
                {
                    return computadoras.FindAll(x => x.Status == "Desactivada").Count;
                }
                else if (Piso == 1)
                {
                    return computadoras.FindAll(x => x.En_Sistema == "Piso 1" && x.Status == "Desactivada").Count;
                }
                else if (Piso == 2)
                {
                    return computadoras.FindAll(x => x.En_Sistema == "Piso 2" && x.Status == "Desactivada").Count;
                }
                else if (Piso == 3)
                {
                    return computadoras.FindAll(x => x.En_Sistema == "Piso 3" && x.Status == "Desactivada").Count;
                }
                else if (Piso == 4)
                {
                    return computadoras.FindAll(x => x.En_Sistema == "Site" && x.Status == "Desactivada").Count;
                }
                break;
            case 1: // Camara
                if (Piso == 0)
                {
                    return camaras.FindAll(x => x.Status == "Desactiva").Count;
                }
                else if (Piso == 1)
                {
                    return camaras.FindAll(x => x.EnSistema == "Piso 1" && x.Status == "Desactiva").Count;
                }
                else if (Piso == 2)
                {
                    return camaras.FindAll(x => x.EnSistema == "Piso 2" && x.Status == "Desactiva").Count;
                }
                else if (Piso == 3)
                {
                    return camaras.FindAll(x => x.EnSistema == "Piso 3" && x.Status == "Desactiva").Count;
                }
                else if (Piso == 4)
                {
                    return camaras.FindAll(x => x.EnSistema == "Site" && x.Status == "Desactiva").Count;
                }
                break;
            case 2: // Alarmas
                if (Piso == 0)
                {
                    return alarmas.FindAll(x => x.Status == "Desactivada").Count;
                }
                else if (Piso == 1)
                {
                    return alarmas.FindAll(x => x.EnSistema == "Piso 1" && x.Status == "Desactivada").Count;
                }
                else if (Piso == 2)
                {
                    return alarmas.FindAll(x => x.EnSistema == "Piso 2" && x.Status == "Desactivada").Count;
                }
                else if (Piso == 3)
                {
                    return alarmas.FindAll(x => x.EnSistema == "Piso 3" && x.Status == "Desactivada").Count;
                }
                else if (Piso == 4)
                {
                    return alarmas.FindAll(x => x.EnSistema == "Site" && x.Status == "Desactivada").Count;
                }
                break;
            case 3: // Puertas
                if (Piso == 0)
                {
                    return doors.FindAll(x => x.Status == "Desactivada").Count;
                }
                else if (Piso == 1)
                {
                    return doors.FindAll(x => x.En_Sistema == "Piso 1" && x.Status == "Desactivada").Count;
                }
                else if (Piso == 2)
                {
                    return doors.FindAll(x => x.En_Sistema == "Piso 2" && x.Status == "Desactivada").Count;
                }
                else if (Piso == 3)
                {
                    return doors.FindAll(x => x.En_Sistema == "Piso 3" && x.Status == "Desactivada").Count;
                }
                else if (Piso == 4)
                {
                    return doors.FindAll(x => x.En_Sistema == "Site" && x.Status == "Desactivada").Count;
                }
                break;
        }
        return 0;
    }

    private int ContadorActivos(int Piso, int Tipo)
    {
        // Piso 
        // 0 = Total
        // 1 = Piso 1
        // 2 = Piso 2
        // 3 = Piso 3
        // 4 = Site
        // Tipo
        // 0 = Computadora
        // 1 = Camara
        // 2 = Alarma
        // 3 = Puerta
        switch (Tipo)
        {
               case 0: // Computadora
                if (Piso == 0)
                {
                    return computadoras.FindAll(x => x.Status == "Activa").Count;
                }
                else if (Piso == 1)
                {
                    return computadoras.FindAll(x => x.En_Sistema == "Piso 1" && x.Status == "Activa").Count;
                }
                else if (Piso == 2)
                {
                    return computadoras.FindAll(x => x.En_Sistema == "Piso 2" && x.Status == "Activa").Count;
                }
                else if (Piso == 3)
                {
                    return computadoras.FindAll(x => x.En_Sistema == "Piso 3" && x.Status == "Activa").Count;
                }
                else if (Piso == 4)
                {
                    return computadoras.FindAll(x => x.En_Sistema == "Site" && x.Status == "Activa").Count;
                }
                break;
            case 1: // Camara
                if (Piso == 0)
                {
                    return camaras.FindAll(x => x.Status == "Activos").Count;
                }
                else if (Piso == 1)
                {
                    return camaras.FindAll(x => x.EnSistema == "Piso 1" && x.Status == "Activos").Count;
                }
                else if (Piso == 2)
                {
                    return camaras.FindAll(x => x.EnSistema == "Piso 2" && x.Status == "Activos").Count;
                }
                else if (Piso == 3)
                {
                    return camaras.FindAll(x => x.EnSistema == "Piso 3" && x.Status == "Activos").Count;
                }
                else if (Piso == 4)
                {
                    return camaras.FindAll(x => x.EnSistema == "Site" && x.Status == "Activos").Count;
                }
                break;
            case 2: // Alarmas
                if (Piso == 0)
                {
                    return alarmas.FindAll(x => x.Status == "Activo").Count;
                }
                else if (Piso == 1)
                {
                    return alarmas.FindAll(x => x.EnSistema == "Piso 1" && x.Status == "Activo").Count;
                }
                else if (Piso == 2)
                {
                    return alarmas.FindAll(x => x.EnSistema == "Piso 2" && x.Status == "Activo").Count;
                }
                else if (Piso == 3)
                {
                    return alarmas.FindAll(x => x.EnSistema == "Piso 3" && x.Status == "Activo").Count;
                }
                else if (Piso == 4)
                {
                    return alarmas.FindAll(x => x.EnSistema == "Site" && x.Status == "Activo").Count;
                }
                break;
            case 3: // Puertas
                if (Piso == 0)
                {
                    return doors.FindAll(x => x.Status == "Activa").Count;
                }
                else if (Piso == 1)
                {
                    return doors.FindAll(x => x.En_Sistema == "Piso 1" && x.Status == "Activo").Count;
                }
                else if (Piso == 2)
                {
                    return doors.FindAll(x => x.En_Sistema == "Piso 2" && x.Status == "Activo").Count;
                }
                else if (Piso == 3)
                {
                    return doors.FindAll(x => x.En_Sistema == "Piso 3" && x.Status == "Activo").Count;
                }
                else if (Piso == 4)
                {
                    return doors.FindAll(x => x.En_Sistema == "Site" && x.Status == "Activo").Count;
                }
                break;
        }
        return 0;
    }

    public void Update()
    {
        if (Total.activeInHierarchy == true)
        {
            // Calcular por cada piso
            // Computadora, camara, alarma, puerta
            TotalesActivados[0].text = ContadorActivos(0, 0).ToString();
            TotalesActivados[1].text = ContadorActivos(0, 1).ToString();
            TotalesActivados[2].text = ContadorActivos(0, 2).ToString();
            TotalesActivados[3].text = ContadorActivos(0, 3).ToString();
            //TotalesActivados[0].text = "24";
            //TotalesActivados[1].text = "75";
            //TotalesActivados[2].text = "45";
            //TotalesActivados[3].text = "38";

            TotalesDesactivado[0].text = ContadorDesactivados(0, 0).ToString();
            TotalesDesactivado[1].text = ContadorDesactivados(0, 1).ToString();
            TotalesDesactivado[2].text = ContadorDesactivados(0, 2).ToString();
            TotalesDesactivado[3].text = ContadorDesactivados(0, 3).ToString();
            // TotalesDesactivado[0].text = "105";
            // TotalesDesactivado[1].text = "0";
            // TotalesDesactivado[2].text = "0";
            //TotalesDesactivado[3].text = "0";
        }
        else if (Piso1.activeInHierarchy == true)
        {
            Piso1Activados[0].text = ContadorActivos(1, 0).ToString();
            Piso1Activados[1].text = ContadorActivos(1, 1).ToString();
            Piso1Activados[2].text = ContadorActivos(1, 2).ToString();
            Piso1Activados[3].text = ContadorActivos(1, 3).ToString();
            //Piso1Activados[0].text = "8";
            //Piso1Activados[1].text = "13";
            //Piso1Activados[2].text = "12";
            //Piso1Activados[3].text = "10";

            Piso1Desactivado[0].text = ContadorDesactivados(1, 0).ToString();
            Piso1Desactivado[1].text = ContadorDesactivados(1, 1).ToString();
            Piso1Desactivado[2].text = ContadorDesactivados(1, 2).ToString();
            Piso1Desactivado[3].text = ContadorDesactivados(1, 3).ToString();
            //Piso1Desactivado[0].text = "9";
            //Piso1Desactivado[1].text = "0";
            //Piso1Desactivado[2].text = "0";
            //Piso1Desactivado[3].text = "0";
        }
        else if (Piso2.activeInHierarchy == true)
        {
            Piso2Activados[0].text = ContadorActivos(2, 0).ToString();
            Piso2Activados[1].text = ContadorActivos(2, 1).ToString();
            Piso2Activados[2].text = ContadorActivos(2, 2).ToString();
            Piso2Activados[3].text = ContadorActivos(2, 3).ToString();
            //Piso2Activados[0].text = "9";
            //Piso2Activados[1].text = "22";
            //Piso2Activados[2].text = "12";
            //Piso2Activados[3].text = "10";

            Piso2Desactivado[0].text = ContadorDesactivados(2, 0).ToString();
            Piso2Desactivado[1].text = ContadorDesactivados(2, 1).ToString();
            Piso2Desactivado[2].text = ContadorDesactivados(2, 2).ToString();
            Piso2Desactivado[3].text = ContadorDesactivados(2, 3).ToString();
            //Piso2Desactivado[0].text = "19";
            //Piso2Desactivado[1].text = "0";
            //Piso2Desactivado[2].text = "0";
            //Piso2Desactivado[3].text = "0";
        }
        else if (Piso3.activeInHierarchy == true)
        {
            // Piso3Activados[0].text = "10";
            // Piso3Activados[1].text = "15";
            // Piso3Activados[2].text = "10";
            // Piso3Activados[3].text = "8";
            Piso3Activados[0].text = ContadorActivos(3, 0).ToString();
            Piso3Activados[1].text = ContadorActivos(3, 1).ToString();
            Piso3Activados[2].text = ContadorActivos(3, 2).ToString();
            Piso3Activados[3].text = ContadorActivos(3, 3).ToString();


            Piso3Desactivado[0].text = ContadorDesactivados(3, 0).ToString();
            Piso3Desactivado[1].text = ContadorDesactivados(3, 1).ToString();
            Piso3Desactivado[2].text = ContadorDesactivados(3, 2).ToString();
            Piso3Desactivado[3].text = ContadorDesactivados(3, 3).ToString();
            // Piso3Desactivado[0].text = "34";
            // Piso3Desactivado[1].text = "0";
            // Piso3Desactivado[2].text = "0";
            //Piso3Desactivado[3].text = "0";
        }
        else if (Site.activeInHierarchy == true)
        {
            SiteActivados[0].
                text = ContadorActivos(4, 0).ToString();
            SiteActivados[1].text = ContadorActivos(4, 1).ToString();
            SiteActivados[2].text = ContadorActivos(4, 2).ToString();
            SiteActivados[3].text = ContadorActivos(4, 3).ToString();

            //SiteActivados[0].text = "13";
            //SiteActivados[1].text = "19";
            //SiteActivados[2].text = "9";
            //SiteActivados[3].text = "8";


            SiteDesactivado[0].text = ContadorDesactivados(4, 0).ToString();
            SiteDesactivado[1].text = ContadorDesactivados(4, 1).ToString();
            SiteDesactivado[2].text = ContadorDesactivados(4, 2).ToString();
            SiteDesactivado[3].text = ContadorDesactivados(4, 3).ToString();

            //
            //SiteDesactivado[0].text = "27";
            //SiteDesactivado[1].text = "0";
            //SiteDesactivado[2].text = "0";
            //SiteDesactivado[3].text = "0";
        }
        /*
        if (virus.avance < 10)
        {
            if (Total.activeInHierarchy == true)
            {
                // Calcular por cada piso
                // Computadora, camara, alarma, puerta
                TotalesActivados[0].text = ContadorActivos(0, 0).ToString();
                TotalesActivados[1].text = ContadorActivos(0, 1).ToString();
                TotalesActivados[2].text = ContadorActivos(0, 2).ToString();
                TotalesActivados[3].text = ContadorActivos(0, 3).ToString();
                //TotalesActivados[0].text = "24";
                //TotalesActivados[1].text = "75";
                //TotalesActivados[2].text = "45";
                //TotalesActivados[3].text = "38";

                TotalesDesactivado[0].text = ContadorDesactivados(0, 0).ToString();
                TotalesDesactivado[1].text = ContadorDesactivados(0, 1).ToString();
                TotalesDesactivado[2].text = ContadorDesactivados(0, 2).ToString();
                TotalesDesactivado[3].text = ContadorDesactivados(0, 3).ToString();
                // TotalesDesactivado[0].text = "105";
                // TotalesDesactivado[1].text = "0";
                // TotalesDesactivado[2].text = "0";
                //TotalesDesactivado[3].text = "0";
            }
            else if (Piso1.activeInHierarchy == true)
            {
                Piso1Activados[0].text = ContadorActivos(1, 0).ToString();
                Piso1Activados[1].text = ContadorActivos(1, 1).ToString();
                Piso1Activados[2].text = ContadorActivos(1, 2).ToString();
                Piso1Activados[3].text = ContadorActivos(1, 3).ToString();
                //Piso1Activados[0].text = "8";
                //Piso1Activados[1].text = "13";
                //Piso1Activados[2].text = "12";
                //Piso1Activados[3].text = "10";

                Piso1Desactivado[0].text = ContadorDesactivados(1, 0).ToString();
                Piso1Desactivado[1].text = ContadorDesactivados(1, 1).ToString();
                Piso1Desactivado[2].text = ContadorDesactivados(1, 2).ToString();
                Piso1Desactivado[3].text = ContadorDesactivados(1, 3).ToString();
                //Piso1Desactivado[0].text = "9";
                //Piso1Desactivado[1].text = "0";
                //Piso1Desactivado[2].text = "0";
                //Piso1Desactivado[3].text = "0";
            }
            else if (Piso2.activeInHierarchy == true)
            {
                Piso2Activados[0].text = ContadorActivos(2, 0).ToString();
                Piso2Activados[1].text = ContadorActivos(2, 1).ToString();
                Piso2Activados[2].text = ContadorActivos(2, 2).ToString();
                Piso2Activados[3].text = ContadorActivos(2, 3).ToString();
                //Piso2Activados[0].text = "9";
                //Piso2Activados[1].text = "22";
                //Piso2Activados[2].text = "12";
                //Piso2Activados[3].text = "10";

                Piso2Desactivado[0].text = ContadorDesactivados(2, 0).ToString();
                Piso2Desactivado[1].text = ContadorDesactivados(2, 1).ToString();
                Piso2Desactivado[2].text = ContadorDesactivados(2, 2).ToString();
                Piso2Desactivado[3].text = ContadorDesactivados(2, 3).ToString();
                //Piso2Desactivado[0].text = "19";
                //Piso2Desactivado[1].text = "0";
                //Piso2Desactivado[2].text = "0";
                //Piso2Desactivado[3].text = "0";
            }
            else if (Piso3.activeInHierarchy == true)
            {
                // Piso3Activados[0].text = "10";
                // Piso3Activados[1].text = "15";
                // Piso3Activados[2].text = "10";
                // Piso3Activados[3].text = "8";
                Piso3Activados[0].text = ContadorActivos(3, 0).ToString();
                Piso3Activados[1].text = ContadorActivos(3, 1).ToString();
                Piso3Activados[2].text = ContadorActivos(3, 2).ToString();
                Piso3Activados[3].text = ContadorActivos(3, 3).ToString();


                Piso3Desactivado[0].text = ContadorDesactivados(3, 0).ToString();
                Piso3Desactivado[1].text = ContadorDesactivados(3, 1).ToString();
                Piso3Desactivado[2].text = ContadorDesactivados(3, 2).ToString();
                Piso3Desactivado[3].text = ContadorDesactivados(3, 3).ToString();
                // Piso3Desactivado[0].text = "34";
                // Piso3Desactivado[1].text = "0";
                // Piso3Desactivado[2].text = "0";
                //Piso3Desactivado[3].text = "0";
            }
            else if (Site.activeInHierarchy == true)
            {
                SiteActivados[0].
                    text = ContadorActivos(4, 0).ToString();
                SiteActivados[1].text = ContadorActivos(4, 1).ToString();
                SiteActivados[2].text = ContadorActivos(4, 2).ToString();
                SiteActivados[3].text = ContadorActivos(4, 3).ToString();

                //SiteActivados[0].text = "13";
                //SiteActivados[1].text = "19";
                //SiteActivados[2].text = "9";
                //SiteActivados[3].text = "8";


                SiteDesactivado[0].text = ContadorDesactivados(4, 0).ToString();
                SiteDesactivado[1].text = ContadorDesactivados(4, 1).ToString();
                SiteDesactivado[2].text = ContadorDesactivados(4, 2).ToString();
                SiteDesactivado[3].text = ContadorDesactivados(4, 3).ToString();

                //
                //SiteDesactivado[0].text = "27";
                //SiteDesactivado[1].text = "0";
                //SiteDesactivado[2].text = "0";
                //SiteDesactivado[3].text = "0";
            }
        }else if(virus.avance >= 10)
        {

            if (Total.activeInHierarchy == true)
            {
                TotalesActivados[0].text = "5";
                TotalesActivados[1].text = "0";
                TotalesActivados[2].text = "0";
                TotalesActivados[3].text = "0";

                TotalesDesactivado[0].text = "118";
                TotalesDesactivado[1].text = "75";
                TotalesDesactivado[2].text = "45";
                TotalesDesactivado[3].text = "38";
            }
            else if (Piso1.activeInHierarchy == true)
            {
                Piso1Activados[0].text = "1";
                Piso1Activados[1].text = "0";
                Piso1Activados[2].text = "0";
                Piso1Activados[3].text = "0";

                Piso1Desactivado[0].text = "11";
                Piso1Desactivado[1].text = "13";
                Piso1Desactivado[2].text = "12";
                Piso1Desactivado[3].text = "10";
            }
            else if (Piso2.activeInHierarchy == true)
            {
                Piso2Activados[0].text = "0";
                Piso2Activados[1].text = "22";
                Piso2Activados[2].text = "12";
                Piso2Activados[3].text = "10";

                Piso2Desactivado[0].text = "28";
                Piso2Desactivado[1].text = "22";
                Piso2Desactivado[2].text = "12";
                Piso2Desactivado[3].text = "10";
            }
            else if (Piso3.activeInHierarchy == true)
            {
                Piso3Activados[0].text = "0";
                Piso3Activados[1].text = "0";
                Piso3Activados[2].text = "0";
                Piso3Activados[3].text = "0";

                Piso3Desactivado[0].text = "44";
                Piso3Desactivado[1].text = "15";
                Piso3Desactivado[2].text = "10";
                Piso3Desactivado[3].text = "8";
            }
            else if (Site.activeInHierarchy == true)
            {
                SiteActivados[0].text = "13";
                SiteActivados[1].text = "0";
                SiteActivados[2].text = "0";
                SiteActivados[3].text = "0";

                SiteDesactivado[0].text = "27";
                SiteDesactivado[1].text = "19";
                SiteDesactivado[2].text = "9";
                SiteDesactivado[3].text = "8";
            }
        }
        */
    }

    public void DropDown(int o)
    {
        switch (o)
        {
            case 0:
                Total.SetActive(true);
                Piso1.SetActive(false);
                Piso2.SetActive(false);
                Piso3.SetActive(false);
                Site.SetActive(false);

                

                break;
            case 1:
                Piso1.SetActive(true);
                Total.SetActive(false);
                Piso2.SetActive(false);
                Piso3.SetActive(false);
                Site.SetActive(false);
                break;
            case 2:
                Piso2.SetActive(true);
                Total.SetActive(false);
                Piso1.SetActive(false);
                Piso3.SetActive(false);
                Site.SetActive(false);
                break;
            case 3:
                Piso3.SetActive(true);
                Total.SetActive(false);
                Piso1.SetActive(false);
                Piso2.SetActive(false);
                Site.SetActive(false);
                break;
            case 4:
                Site.SetActive(true);
                Total.SetActive(false);
                Piso1.SetActive(false);
                Piso2.SetActive(false);
                Piso3.SetActive(false);
                break;
        }
    }

   
}
