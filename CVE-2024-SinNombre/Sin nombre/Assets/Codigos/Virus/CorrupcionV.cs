using System.Collections;
using System.Collections.Generic;
using Unity.VisualScripting.Antlr3.Runtime;
using UnityEngine;
using UnityEngine.UI;
using UnityEngine.Video;
using UnityEngine.SceneManagement;


public class CorrupcionV : MonoBehaviour
{
    public Virus virus;
    public IACorrupcion IAVirus;
    public ChatControlador AppChatEquipo;

    //Virus corrupcion en energia
    [SerializeField]
    private Image NEnergia; //controlador del indicador de energia.
    private float Energia; 
    [SerializeField]
    private TMPro.TextMeshProUGUI porcentaje;

    [SerializeField]
    private GameObject AdvertenciasIn;
    [SerializeField]
    private GameObject PantallaOculta;
    //public CambioPantalla Errores;

    //_____PYP
    GameObject PYPFueraServicio;
    GameObject InventarioPre;
    //_____PYBD
    GameObject PYBDFueraServico;
    //____AppArchivos
    GameObject AppArchivos;
    //____AppControl
    GameObject AppControl;

    public ListasComputadoras virusActivoComp;
    public ListasCamaras virusActCamaras;
    public AlarmasListas virusActivoAlar;
    public ListasControl virusActivoPuertas;

    //Pruebas

    public bool PruebaF;
    public float timeP = 10;

    public void Start()
    {
        
        //Corrupcion en las funciones de la aplicacion PYBD
        PYBDFueraServico = GameObject.Find("Control PYBD");

        //Corrupcion en las funciones de la aplicacion Archivos.
        AppArchivos = GameObject.Find("AplicacionArchivos");

        //Courrupcion en las funciones de la aplicacion Control.
        AppControl = GameObject.Find("AplicacionControl");

        //Corrupcion en las funciones de la aplicacion PYP
        InventarioPre = GameObject.Find("InventariosPre");
        PYPFueraServicio = GameObject.Find("Control PYP");
    }

    public void Update()
    {
        NCAppPYP();
        NCAppPYBD();
        NCAppArchivos();
        NCAppControl();
        NCAppChatE();

        IAvirusC();

        virus.avance = Mathf.Clamp(virus.avance, 0, 100);
        NEnergia.fillAmount = virus.avance / 100;

        Energia = 100 - virus.avance;

        porcentaje.text = Energia.ToString("00") + "%";
        // Guardar el tiempo en PlayerPrefs
        PlayerPrefs.SetFloat("Tiempo", virus.avance);

        //Pruebas();
        ActivadoListas();
       
    }

    public void ActivadoListas()
    {
       if(virus.avance >= 10 && virus.avance < 10.1)
        {
            virusActivoComp.virus_activo = true;
            virusActCamaras.virus_activo = true;
            virusActivoAlar.virus_activo = true;
            virusActivoPuertas.virus_activo = true;

        }else if(virus.avance >= 10.1)
        {
            virusActivoComp.virus_activo = false;
            virusActCamaras.virus_activo = false;
            virusActivoAlar.virus_activo = false;
            virusActivoPuertas.virus_activo = false;
        }
    }

    public void NCAppPYP() //Nivel de corrupcion en la aplicacion Proyect Y Program.
    {
        //Disminucion drastrica del inventario.
        if (virus.avance >= 10)
        {
            InventarioPre.SetActive(false);
            AdvertenciasIn.SetActive(true);
        }
        if (virus.avance < 10)
        {
            InventarioPre.SetActive(true);
            AdvertenciasIn.SetActive(false);
        }
        
        if (virus.avance >= 45)
        {

            PYPFueraServicio.SetActive(false);
        }
        if (virus.avance < 35)
        {
            PYPFueraServicio.SetActive(true);
        }
    }

    public void SalvacionAppPYP()
    {
        
            PYPFueraServicio.SetActive(false);
        
    }

    public void NCAppPYBD()
    {
        
        if (virus.avance >= 75)
        {

            PYBDFueraServico.SetActive(false);
        }
    }

    public void NCAppArchivos()
    {
        if (virus.avance >= 80)
        {
            AppArchivos.SetActive(false);
        }
    }

    public void NCAppControl()
    {
        if (virus.avance >= 94)
        {
            AppControl.SetActive(false);
        }
    }

    public void NCAppChatE()
    {
        if(virus.avance >= 10.2)
        {
            AppChatEquipo.ChatsElimados();
        }
    }

    public void IAvirusC()
    {
        if(virus.avance >= 20 && virus.avance <= 20.2)
        {
            IAVirus.elegido = true;
        }
        if (virus.avance >= 30 && virus.avance <= 30.1)
        {
            IAVirus.elegido = true;
        }
        if (virus.avance >= 50 && virus.avance <= 50.1)
        {
            IAVirus.elegido = true;
        }
        if (virus.avance >= 60 && virus.avance <= 60.1)
        {
            IAVirus.elegido = true;
        }
        if (virus.avance >= 70 && virus.avance <= 70.1)
        {
            IAVirus.elegido = true;
        }
        if (virus.avance >= 80 && virus.avance <= 80.1)
        {
            IAVirus.elegido = true;
        }
    }
   
}
