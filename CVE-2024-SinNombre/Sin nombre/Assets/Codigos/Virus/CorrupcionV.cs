using System.Collections;
using System.Collections.Generic;
using Unity.VisualScripting.Antlr3.Runtime;
using UnityEngine;
using UnityEngine.UI;
using UnityEngine.Video;
using UnityEngine.SceneManagement;


public class CorrupcionV : MonoBehaviour
{
    public Virus virus;

    //Virus corrupcion en energia
    [SerializeField]
    private Image NEnergia; //controlador del indicador de energia.
    private float Energia; 
    [SerializeField]
    private TMPro.TextMeshProUGUI porcentaje;

    [SerializeField]
    private GameObject AdvertenciasIn;
    [SerializeField]
    private GameObject PantallaOculta;
    //public CambioPantalla Errores;

    //_____PYP
    GameObject PYPFueraServicio;
    GameObject InventarioPre;
    //_____PYBD
    GameObject PYBDFueraServico;
    //____AppArchivos
    GameObject AppArchivos;
    //____AppControl
    GameObject AppControl;

    

    //Pruebas

    public bool PruebaF;
    public float timeP = 10;

    public void Start()
    {


        //Corrupcion en las funciones de la aplicacion PYBD
        PYBDFueraServico = GameObject.Find("Control PYBD");

        //Corrupcion en las funciones de la aplicacion Archivos.
        AppArchivos = GameObject.Find("AplicacionArchivos");

        //Courrupcion en las funciones de la aplicacion Control.
        AppControl = GameObject.Find("AplicacionControl");

        //Corrupcion en las funciones de la aplicacion PYP
        InventarioPre = GameObject.Find("InventariosPre");
        PYPFueraServicio = GameObject.Find("Control PYP");
    }

    public void Update()
    {
        NCAppPYP();
        NCAppPYBD();
        NCAppArchivos();
        NCAppControl();
        HackeoFaltaTiempo();

        virus.avance = Mathf.Clamp(virus.avance, 0, 100);
        NEnergia.fillAmount = virus.avance / 100;

        Energia = 100 - virus.avance;

        porcentaje.text = Energia.ToString() + "%";


        Pruebas();
       
    }

    public void Pruebas()
    {
        if (Input.GetKeyDown(KeyCode.Q))
        {
            timeP++;
            virus.avance = timeP;
        }
        if (Input.GetKeyDown(KeyCode.F))
        {
            PruebaF = true;
        }

        if (PruebaF == true)
        {
            SceneManager.LoadScene(2);
        }
    }

    public void NCAppPYP() //Nivel de corrupcion en la aplicacion Proyect Y Program.
    {


        //Disminucion drastrica del inventario.
        if (virus.avance >= 10)
        {
            InventarioPre.SetActive(false);
            AdvertenciasIn.SetActive(true);
        }
        if (virus.avance < 10)
        {
            InventarioPre.SetActive(true);
            AdvertenciasIn.SetActive(false);
        }

        if (virus.avance >= 45)
        {

            PYPFueraServicio.SetActive(false);
        }
        if (virus.avance < 45) //este lo voy a eliminar
        {
            PYPFueraServicio.SetActive(true);
        }
    }

    public void NCAppPYBD()
    {
        if (virus.avance >= 75)
        {

            PYBDFueraServico.SetActive(false);
        }
    }

    public void NCAppArchivos()
    {
        if (virus.avance >= 80)
        {
            AppArchivos.SetActive(false);
        }
    }

    public void NCAppControl()
    {
        if (virus.avance >= 94)
        {
            AppControl.SetActive(false);
        }
    }

    public void HackeoFaltaTiempo()
    {
        if (virus.avance == 100)
        { 
            Debug.Log("Informacion obtenida");
            SceneManager.LoadScene(2);

        }
    }
}
